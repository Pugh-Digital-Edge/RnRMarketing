---
import BaseLayout from "src/layouts/BaseLayout.astro";
import services from '@data/serviceData.json';
import industries from '@data/industriesData.json';
import Articles from "@components/Articles.astro";
import Contact from "@components/Contact.astro";
import Landing from "@components/Landing.astro";

export async function getStaticPaths() {
  const paths = services.flatMap(service =>
    industries.map(industry => ({
      params: { service: service.Name, industry: industry.Name },  // Use `service` and `industry` keys here
    }))
  );

  return paths;  // Return as an object with `paths` key
}

// Access route parameters directly from `Astro.params`
const { service, industry } = Astro.params;  // Use `service` and `industry`
console.log("Astro.params:", Astro.params);

const selectedService = services.find(s => s.Name === service);
const selectedIndustry = industries.find(l => l.Name === industry);

if (!selectedService || !selectedIndustry) {
  throw new Error("Service or industry not found: " + service + " " + industry);
}

// Optimize landing image if necessary
import { getOptimizedImage } from "@libs/utils";
import landingImage from "@assets/images/landing.jpg"; // Path to preload asset in src
const optimizedImage = await getOptimizedImage(landingImage);
---

<BaseLayout
  title={`${selectedService.FormalName} for ${selectedIndustry.FormalName}`}
  description={`Specialized ${selectedService.FormalName} services designed specifically for ${selectedIndustry.FormalName} companies. Drive more emergency restoration leads and grow your ${selectedIndustry.Name} business.`}
  preloadedImage={optimizedImage}
>
<Landing 
    title={`${selectedService.FormalName} for ${selectedIndustry.FormalName}`}
    image={optimizedImage}
/>

<!-- ============================================ -->
<!--           Primary Service Section            -->
<!-- ============================================ -->

<section id="RTsbs-1365">
    <div class="cs-container">
        <div class="cs-image-group">
            <picture class="cs-background">
                <source media="(max-width: 600px)" srcset={`/assets/images${selectedService.ImagePath}-m.webp`} />
                <source media="(min-width: 601px)" srcset={`/assets/images${selectedService.ImagePath}.webp`} />
                <img loading="lazy" decoding="async" src={`/assets/images${selectedService.ImagePath}.webp`} alt={`${selectedService.FormalName} for ${selectedIndustry.FormalName}`} width="690" height="690">
            </picture>
        </div>
        <div class="cs-content">
            <span class="cs-topper">{selectedIndustry.FormalName} EXPERTS</span>
            <h2 class="cs-title">{selectedService.Title1}</h2>
            <p class="cs-text">
                {selectedIndustry.Description}
            </p>
            <p class="cs-text">
                <div set:html={selectedService.Description1}></div>
            </p>           
            <a href="/contact" class="cs-button-solid">Schedule Your Strategy Call</a>
        </div>
    </div>
    <div class="cs-bubbles" aria-hidden="true"></div>
</section>

<!-- ============================================ -->
<!--            Industry-Specific Benefits        -->
<!-- ============================================ -->

<section id="RTsbsr-1365">
    <div class="cs-container">
        <div class="cs-image-group">
            <picture class="cs-background">
                <source media="(max-width: 600px)" srcset={`/assets/images${selectedIndustry.ImagePath}-m.webp`} />
                <source media="(min-width: 601px)" srcset={`/assets/images${selectedIndustry.ImagePath}.webp`} />
                <img loading="lazy" decoding="async" src={`/assets/images${selectedIndustry.ImagePath}.webp`} alt={`${selectedService.FormalName} Benefits for ${selectedIndustry.FormalName}`} width="690" height="690">
            </picture>
        </div>
        <div class="cs-content">
            <span class="cs-topper">SPECIALIZED SOLUTIONS</span>
            <h2 class="cs-title">{selectedService.Title2}</h2>
            <p class="cs-text">
                <div set:html={selectedService.Description2}></div>
            </p>   
            
            <ul class="cs-ul">
                <li class="cs-li">
                    <span class="cs-header">24/7 Emergency Focus</span>
                    <p>Capture urgent {selectedIndustry.Name} calls when property owners need immediate help</p>
                </li>
                <li class="cs-li">
                    <span class="cs-header">Industry Expertise</span>
                    <p>Specialized {selectedService.FormalName} strategies for {selectedIndustry.Name} companies</p>
                </li>
                <li class="cs-li">
                    <span class="cs-header">Quality Lead Generation</span>
                    <p>Target property owners and insurance partners, not unqualified leads</p>
                </li>
            </ul>
            
            <a href="/case-studies" class="cs-button-solid">Learn More</a>
        </div>
    </div>
    <div class="cs-bubbles" aria-hidden="true"></div>
</section>

<!-- ============================================ -->
<!--            Complete Solution                 -->
<!-- ============================================ -->

<section id="RTsbst-1365">
    <div class="cs-container">
        <div class="cs-image-group">
            <picture class="cs-background">
                <source media="(max-width: 600px)" srcset={`/assets/images${selectedService.ImagePath2}-m.webp`} />
                <source media="(min-width: 601px)" srcset={`/assets/images${selectedService.ImagePath2}.webp`} />
                <img loading="lazy" decoding="async" src={`/assets/images${selectedService.ImagePath2}.webp`} alt={`Complete ${selectedService.FormalName} Solution`} width="690" height="690">
            </picture>
        </div>
        <div class="cs-content">
            <span class="cs-topper">COMPLETE SOLUTION</span>
            <h2 class="cs-title">Get More {selectedIndustry.FormalName} Jobs</h2>
            <p class="cs-text">
                Our comprehensive {selectedService.FormalName} solution is designed specifically for {selectedIndustry.Name} companies. We understand the unique challenges of marketing emergency restoration services and have developed proven strategies to help you:
            </p>            
            
            <ul class="cs-ul">
                <li class="cs-li">Capture more emergency calls</li>
                <li class="cs-li">Build relationships with insurance partners</li>
                <li class="cs-li">Establish local market authority</li>
                <li class="cs-li">Track and improve marketing ROI</li>
            </ul>

            <a href="/contact" class="cs-button-solid">Book Your Strategy Call</a>
        </div>
    </div>
    <div class="cs-bubbles" aria-hidden="true"></div>
</section>
                            
<!-- ============================================ -->
<!--                   CTA                        -->
<!-- ============================================ -->

<section id="cta-1365">
    <div class="cs-container">
        <div class="cs-content">
            <span class="cs-topper">GET STARTED TODAY</span>
            <h2 class="cs-title">Ready to Grow Your {selectedIndustry.FormalName} Business?</h2>
            <p class="cs-text">
                Schedule a free strategy call to learn how our {selectedService.FormalName} services can help you get more {selectedIndustry.Name} jobs.
            </p>
            <a href="/contact" class="cs-button-solid">Schedule Your Strategy Call</a>
        </div>
    </div>
</section>

<Articles />
<Contact />
</BaseLayout>
<style lang="less">
    /*-- -------------------------- -->
    <---        Content Page        -->
    <--- -------------------------- -*/
    
    /* Mobile - 360px */
    @media only screen and (min-width: 0rem) {
        @keyframes floatAnimation {
            0% {
                transform: translateY(0);
            }
              
    </style>